angular.module('AgaveToGo').controller('JobsDirectoryController', function ($scope, JobsController, ActionsService) {    $scope._COLLECTION_NAME = 'jobs';    $scope._RESOURCE_NAME = 'job';    $scope.offset = 0;    $scope.limit = 10;    $scope.sortType = 'startTime';    $scope.sortReverse  = true;    $scope.query = '';    $scope.refresh = function() {      $scope.requesting = true;      JobsController.searchJobs(        $scope.query      )        .then(          function (response) {            $scope.totalItems = response.result.length;            $scope.pagesTotal = Math.ceil(response.result.length / $scope.limit);            $scope[$scope._COLLECTION_NAME] = response.result;            $scope.requesting = false;          },          function(response){            var message = '';            if (response.errorResponse.message) {              message = 'Error: Could not retrieve jobs - ' + response.errorResponse.message            } else if (response.errorResponse.fault){              message = 'Error: Could not retrieve jobs - ' + response.errorResponse.fault.message;            } else {              message = 'Error: Could not retrieve jobs';            }            App.alert(              {                type: 'danger',                message: message              }            );            $scope.requesting = false;          }      );    };    $scope.searchTools = function(query){      $scope.query = query;      $scope.refresh();    }    $scope.browse = function(id){      JobsController.getJobDetails(id)        .then(          function(response){            $state.go('data-explorer', {'systemId': response.result.archiveSystem, path: response.result.archivePath});          },          function(response){            var message = '';            if (response.errorResponse.message) {              message = 'Error: Could not retrieve jobs - ' + response.errorResponse.message            } else if (response.errorResponse.fault){              message = 'Error: Could not retrieve jobs - ' + response.errorResponse.fault.message;            } else {              message = 'Error: Could not retrieve jobs';            }            App.alert(              {                type: 'danger',                message: message              }            );            $scope.requesting = false;          }        );    }    $scope.refresh();    $scope.confirmAction = function(resourceType, resource, resourceAction, resourceList, resourceIndex){      ActionsService.confirmAction(resourceType, resource, resourceAction, resourceList, resourceIndex);    }});